(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{383:function(s,t,a){"use strict";a.r(t);var e=a(44),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"flow-run-task"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#flow-run-task"}},[s._v("#")]),s._v(" Flow Run Task")]),s._v(" "),a("p",[s._v("Flow Run task enables running another Flow spec as a task.")]),s._v(" "),a("h2",{attrs:{id:"example-usage-path"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#example-usage-path"}},[s._v("#")]),s._v(" Example Usage (Path)")]),s._v(" "),a("p",[s._v('Assume you have a flow spec already, you can use "flow_run" task to trigger the flow run.')]),s._v(" "),a("p",[s._v("You can set "),a("code",[s._v("path")]),s._v(" to specify which flow spec to run.")]),s._v(" "),a("div",{staticClass:"language-hcl extra-class"},[a("pre",{pre:!0,attrs:{class:"language-hcl"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# File: flow_example")]),s._v("\nflow "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"flow_example"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  task "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"flow_run"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v("path")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./examples/hello.hcl"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("details",{staticClass:"custom-block details"},[a("summary",[s._v("Click me to view the run output")]),s._v(" "),a("p",[s._v("Run:")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ runflow run examples/flow_by_path.hcl\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("-07-04 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":01:58,735"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"task.flow_run.echo"')]),s._v(" is started.\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("-07-04 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":01:58,737"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"task.flow_run.echo > task.bash_run.echo"')]),s._v(" is started.\nhello world\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("-07-04 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":01:58,745"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"task.flow_run.echo > task.bash_run.echo"')]),s._v(" is successful.\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("-07-04 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":01:58,746"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"task.flow_run.echo"')]),s._v(" is successful.\n")])])])]),s._v(" "),a("h2",{attrs:{id:"example-usage-module"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#example-usage-module"}},[s._v("#")]),s._v(" Example Usage (Module)")]),s._v(" "),a("p",[s._v("You can set "),a("code",[s._v("module")]),s._v(" to specify which flow spec to run.")]),s._v(" "),a("div",{staticClass:"language-hcl extra-class"},[a("pre",{pre:!0,attrs:{class:"language-hcl"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# File: flow_by_module.hcl")]),s._v("\nflow "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"flow_by_module"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  task "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"flow_run"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v("module")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"examples.hello:flow"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("details",{staticClass:"custom-block details"},[a("summary",[s._v("Click me to view the run output")]),s._v(" "),a("p",[s._v("Run:")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ runflow run examples/flow_by_module.hcl\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("-07-04 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":02:37,230"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"task.flow_run.echo"')]),s._v(" is started.\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("-07-04 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":02:37,235"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"task.flow_run.echo > task.bash_run.echo"')]),s._v(" is started.\nhello world\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("-07-04 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":02:37,244"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"task.flow_run.echo > task.bash_run.echo"')]),s._v(" is successful.\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("-07-04 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":02:37,244"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"task.flow_run.echo"')]),s._v(" is successful.\n")])])])]),s._v(" "),a("h2",{attrs:{id:"set-flow-variables"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#set-flow-variables"}},[s._v("#")]),s._v(" Set Flow Variables")]),s._v(" "),a("p",[s._v("If the dependent flow requires variables, you can set "),a("code",[s._v("vars")]),s._v(". It's a key-value mapping.")]),s._v(" "),a("div",{staticClass:"language-hcl extra-class"},[a("pre",{pre:!0,attrs:{class:"language-hcl"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# File: subflow_vars.hcl")]),s._v("\nflow "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"subflow_vars"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  task "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"flow_run"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"this"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v("path")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./examples/hello-vars.hcl"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v("vars")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v("greeter")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"世界"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("details",{staticClass:"custom-block details"},[a("summary",[s._v("Click me to view the run output")]),s._v(" "),a("p",[s._v("Run:")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ runflow run examples/subflow_vars.hcl\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("-07-04 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":02:53,064"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"task.flow_run.this"')]),s._v(" is started.\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("-07-04 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":02:53,068"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"task.flow_run.this > task.bash_run.echo"')]),s._v(" is started.\nhello 世界\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("-07-04 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":02:53,078"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"task.flow_run.this > task.bash_run.echo"')]),s._v(" is successful.\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("-07-04 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v(":02:53,078"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"task.flow_run.this"')]),s._v(" is successful.\n")])])])]),s._v(" "),a("h2",{attrs:{id:"export-flow-context"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#export-flow-context"}},[s._v("#")]),s._v(" Export Flow Context")]),s._v(" "),a("p",[s._v("You can set an optional argument "),a("code",[s._v("export")]),s._v(" to bring the values in the inner\nflow run context to the outer flow context.")]),s._v(" "),a("div",{staticClass:"language-hcl extra-class"},[a("pre",{pre:!0,attrs:{class:"language-hcl"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# File: flow_exports")]),s._v("\nflow "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"flow_exports"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n  task "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"flow_run"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"echo"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v("path")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./examples/hello.hcl"')]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# You can set as many custom fields in `export` block,")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# as long as the values in block are valid variable references")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# in the flow `./examples/hello.hcl`.")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# In this example, since `task "bash_run" "echo" {...}`')]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# has attribute `stdout`, you can export the stdout value")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# and bind it to any field name, like `custom_field`.")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v("custom_field")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"task.bash_run.echo.stdout"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n  task "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"file_write"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"re-echo"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v("filename")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/dev/stdout"')]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Now we can use `task.flow_run.echo.custom_field` data.")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v("content")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" task.flow_run.echo.custom_field\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("details",{staticClass:"custom-block details"},[a("summary",[s._v("Click me to view the run output")]),s._v(" "),a("p",[s._v("Run:")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('$ runflow run examples/flow_exports.hcl\n[2021-07-04 17:03:11,601] "task.flow_run.echo" is started.\n[2021-07-04 17:03:11,603] "task.flow_run.echo > task.bash_run.echo" is started.\nhello world\n[2021-07-04 17:03:11,613] "task.flow_run.echo > task.bash_run.echo" is successful.\n[2021-07-04 17:03:11,614] "task.flow_run.echo" is successful.\n[2021-07-04 17:03:11,614] "task.file_write.re-echo" is started.\nhello world\n[2021-07-04 17:03:11,617] "task.file_write.re-echo" is successful.\n')])])])]),s._v(" "),a("h2",{attrs:{id:"argument-reference"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#argument-reference"}},[s._v("#")]),s._v(" Argument Reference")]),s._v(" "),a("p",[s._v("The following arguments are supported:")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("path")]),s._v(" - (Optional, str) The path to the "),a("code",[s._v('".hcl"')]),s._v(" file.")]),s._v(" "),a("li",[a("code",[s._v("module")]),s._v(" - (Optional, str) The import module to the "),a("code",[s._v('".hcl"')]),s._v(" module.")]),s._v(" "),a("li",[a("code",[s._v("source")]),s._v(" - (Optional, str) The source of Runflow spec.")]),s._v(" "),a("li",[a("code",[s._v("vars")]),s._v(" - (Optional, map) The variables for running a flow.")]),s._v(" "),a("li",[a("code",[s._v("export")]),s._v(" - (Optional, block) The exported variables. The key will be used as task attribute name, and the value should be a valid reference in the inner flow run.")])]),s._v(" "),a("h2",{attrs:{id:"attributes-reference"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#attributes-reference"}},[s._v("#")]),s._v(" Attributes Reference")]),s._v(" "),a("p",[s._v("The following attributes are supported:")]),s._v(" "),a("ul",[a("li",[s._v("Any key specified in argument "),a("code",[s._v("exports")]),s._v(" can be used.")])])])}),[],!1,null,null,null);t.default=n.exports}}]);